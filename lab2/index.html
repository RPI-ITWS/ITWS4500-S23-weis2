<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ITWS-weis2-lab2</title>
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/index.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header col-md-6 col-md-push-5 col-sm-6 col-sm-push-4">
                <a class="navbar-brand" href="https://openweathermap.org/API" id="title">Open Weather</a>
            </div>
        </div>
    </nav>
    <div class="container" style = "background-color:lightblue; height: 1000px; width: 800px;">

        <p id="demo"></p>
        <div class="row">
            <div id="Location"></div>
            <div id="DateTime"></div>
        </div>
        <div class="row">
            <div class="col-md-6 col-sm-4 col-md-push-2 col-sm-push-2" id="IMG">
                <img  width="80" height="80" src="" id="TempImg">
            </div>
            <div class="col-md-5 col-sm-5 col-md-push-1 col-sm-push-1" id="Description"></div>
        </div>
        <div class="row">
            <div class="col-md-6 col-sm-4 col-md-push-2 col-sm-push-2" id="Temp"></div>
            <div class="col-md-6 col-sm-6 col-md-push-2 col-sm-push-2" id="Wind"></div>
            <div class="col-md-6 col-sm-4 col-md-push-2 col-sm-push-2" id="Humidity"></div>
        </div>
        <div class="row">
            <div class="col-md-3 col-sm-4 col-md-push-2 col-sm-push-2" id="Range"></div>
        </div>
    </div>
    <!-- <div class="container-fluid" style = "background-color: thistle; height: 500px;">
        hello world
    </div> -->
<script>
    var x = document.getElementById("demo");
    var key = "6c383ebc2e93c8bc6263010e56b6fdb4";
    var metric = "&units=metric";
    getLocation();

    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition((position) => {
                var lat = position.coords.latitude.toFixed(3);
                console.log(lat);
                var lon = position.coords.longitude.toFixed(3);
                console.log(lon);
            
            
            var api = "https://api.openweathermap.org/data/2.5/weather?lat="+lat+"&lon="+lon+"&appid="+key+metric;
            console.log(api);

            fetch(api)
                .then(response => response.json())
                .then(json => {
                    document.getElementById("Location").innerHTML += json.name;
                    document.getElementById("Description").innerHTML += json.weather[0].description;
                    var tempCel = json.main.temp;
                    var tempmax = json.main.temp_max;
                    var tempmin = json.main.temp_min;
                    document.getElementById("Wind").innerHTML += "<p class='text'> Wind Speed: " + json.wind.speed + "mps"+"</p>";  
                    document.getElementById("Humidity").innerHTML += "<p class='text'> Humidity: " + json.main.humidity + "%" + "</p>";            
                    document.getElementById("Temp").innerHTML += "<p id='TempNum'>" + Math.round(tempCel) + "</p>" + "<p id='Celsymbol'>℃</p>";
                    document.getElementById("TempImg").src= "http://openweathermap.org/img/wn/"+ json.weather[0].icon + "@2x.png";
                    document.getElementById("Range").innerHTML += "<p class='text'>" + Math.round(tempmax) + "℃" + "  ~  " + Math.round(tempmin) + "℃" + "</p>"; 
                })
                .catch(err => console.log('Request Failed', err));
                })
        }
    }

    // function getLocaltime(){
    //     return new Date().toLocaleTimeString();
    // }

    timemove();

    function timemove() {

        // var date = new Date();
        // var year = date.getFullYear();
        // var mth = date.getMonth() + 1;
        // var d = date.getDate();
        // var h = date.getHours();
        // var m = date.getMinutes();
        // var s = date.getSeconds();
        // var week = date.getDay();

        // var time = year + "Year" + fn(mth) + "Month" + fn(d) + "Day" + fn(h) + ":" + fn(m) +  ":" + fn(s) +"（Week"+week+"）";
        
        // function fn(str) {
        //     str < 10 ? str = "0" + str : str;
        //     return str;
        // }
        
        setInterval(timemove, 1000);
        DateTime.innerHTML = new Date().toString();
        clearInterval(timemove, 100000);
    }

    // function getTimeZone() {
    //     var offset = new Date().getTimezoneOffset(), o = Math.abs(offset);
    //     return (offset < 0 ? "+" : "-") + ("00" + Math.floor(o / 60)).slice(-2) + ":" + ("00" + (o % 60)).slice(-2);
    // }

    // DateTime.innerHTML += getTimeZone();
</script>
<script src="js/jquery-3.6.3.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
    
</body>
</html>